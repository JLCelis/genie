<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Tue Mar 12 00:05:18 UTC 2019 -->
<title>JpaClusterRepository (genie 3.3.18-SNAPSHOT API)</title>
<meta name="date" content="2019-03-12">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="JpaClusterRepository (genie 3.3.18-SNAPSHOT API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html" title="interface in com.netflix.genie.core.jpa.repositories"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaCommandRepository.html" title="interface in com.netflix.genie.core.jpa.repositories"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html" target="_top">Frames</a></li>
<li><a href="JpaClusterRepository.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.netflix.genie.core.jpa.repositories</div>
<h2 title="Interface JpaClusterRepository" class="title">Interface JpaClusterRepository</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Superinterfaces:</dt>
<dd><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html" title="interface in com.netflix.genie.core.jpa.repositories">JpaBaseRepository</a>&lt;<a href="../../../../../../com/netflix/genie/core/jpa/entities/ClusterEntity.html" title="class in com.netflix.genie.core.jpa.entities">ClusterEntity</a>&gt;</dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">JpaClusterRepository</span>
extends <a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html" title="interface in com.netflix.genie.core.jpa.repositories">JpaBaseRepository</a>&lt;<a href="../../../../../../com/netflix/genie/core/jpa/entities/ClusterEntity.html" title="class in com.netflix.genie.core.jpa.entities">ClusterEntity</a>&gt;</pre>
<div class="block">Cluster repository.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#CLUSTER_COMMAND_QUERY">CLUSTER_COMMAND_QUERY</a></span></code>
<div class="block">This is the query used to find clusters and commands for given criteria from a user.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL">DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL</a></span></code>
<div class="block">For referential integrity before clusters are deleted remove all command links.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL">DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL</a></span></code>
<div class="block">For referential integrity before clusters are deleted remove all config file references.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL">DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL</a></span></code>
<div class="block">For referential integrity before clusters are deleted remove all dependency file references.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#DELETE_TERMINATED_CLUSTERS_SQL">DELETE_TERMINATED_CLUSTERS_SQL</a></span></code>
<div class="block">The SQL to find all clusters in a TERMINATED state that aren't attached to any jobs still in the database.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL">DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL</a></span></code>
<div class="block">For referential integrity before clusters are deleted remove all tag references.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#deleteTerminatedClusters--">deleteTerminatedClusters</a></span>()</code>
<div class="block">Delete all clusters that are in a terminated state and aren't attached to any jobs.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#deleteTerminatedClustersCommandsReferences--">deleteTerminatedClustersCommandsReferences</a></span>()</code>
<div class="block">Delete all links to clusters that are about to be terminated from commands.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#deleteTerminatedClustersConfigsFileReferences--">deleteTerminatedClustersConfigsFileReferences</a></span>()</code>
<div class="block">Delete all links to clusters that are about to be terminated from config file references.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#deleteTerminatedClustersDependenciesFileReferences--">deleteTerminatedClustersDependenciesFileReferences</a></span>()</code>
<div class="block">Delete all links to clusters that are about to be terminated from dependency file references.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#deleteTerminatedClustersTagsReferences--">deleteTerminatedClustersTagsReferences</a></span>()</code>
<div class="block">Delete all links to clusters that are about to be terminated from tags.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.Object[]&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html#findClustersAndCommandsForCriterion-java.util.Set-int-java.util.Set-int-">findClustersAndCommandsForCriterion</a></span>(java.util.Set&lt;java.lang.String&gt;&nbsp;clusterTags,
                                   int&nbsp;clusterTagsCount,
                                   java.util.Set&lt;java.lang.String&gt;&nbsp;commandTags,
                                   int&nbsp;commandTagsSize)</code>
<div class="block">Find the cluster and command ids for the given criterion tags.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.netflix.genie.core.jpa.repositories.JpaBaseRepository">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;com.netflix.genie.core.jpa.repositories.<a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html" title="interface in com.netflix.genie.core.jpa.repositories">JpaBaseRepository</a></h3>
<code><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html#existsByUniqueId-java.lang.String-">existsByUniqueId</a>, <a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html#findByUniqueId-java.lang.String-">findByUniqueId</a>, <a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html#findByUniqueId-java.lang.String-java.lang.Class-">findByUniqueId</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.springframework.data.jpa.repository.JpaRepository">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.springframework.data.jpa.repository.JpaRepository</h3>
<code>deleteAllInBatch, deleteInBatch, findAll, findAll, findAll, findAll, findAll, flush, getOne, save, saveAndFlush</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.springframework.data.repository.PagingAndSortingRepository">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.springframework.data.repository.PagingAndSortingRepository</h3>
<code>findAll</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.springframework.data.repository.CrudRepository">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.springframework.data.repository.CrudRepository</h3>
<code>count, delete, delete, delete, deleteAll, exists, findOne, save</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.springframework.data.repository.query.QueryByExampleExecutor">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.springframework.data.repository.query.QueryByExampleExecutor</h3>
<code>count, exists, findAll, findOne</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.org.springframework.data.jpa.repository.JpaSpecificationExecutor">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;org.springframework.data.jpa.repository.JpaSpecificationExecutor</h3>
<code>count, findAll, findAll, findAll, findOne</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="CLUSTER_COMMAND_QUERY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CLUSTER_COMMAND_QUERY</h4>
<pre>static final&nbsp;java.lang.String CLUSTER_COMMAND_QUERY</pre>
<div class="block">This is the query used to find clusters and commands for given criteria from a user.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.CLUSTER_COMMAND_QUERY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DELETE_TERMINATED_CLUSTERS_SQL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DELETE_TERMINATED_CLUSTERS_SQL</h4>
<pre>static final&nbsp;java.lang.String DELETE_TERMINATED_CLUSTERS_SQL</pre>
<div class="block">The SQL to find all clusters in a TERMINATED state that aren't attached to any jobs still in the database.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.DELETE_TERMINATED_CLUSTERS_SQL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL</h4>
<pre>static final&nbsp;java.lang.String DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL</pre>
<div class="block">For referential integrity before clusters are deleted remove all tag references.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.DELETE_TERMINATED_CLUSTERS_TAGS_REFERENCES_SQL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL</h4>
<pre>static final&nbsp;java.lang.String DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL</pre>
<div class="block">For referential integrity before clusters are deleted remove all config file references.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.DELETE_TERMINATED_CLUSTERS_CONFIGS_FILE_REFERENCES_SQL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL</h4>
<pre>static final&nbsp;java.lang.String DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL</pre>
<div class="block">For referential integrity before clusters are deleted remove all dependency file references.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.DELETE_TERMINATED_CLUSTERS_DEPENDENCIES_FILE_REFERENCES_SQL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL</h4>
<pre>static final&nbsp;java.lang.String DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL</pre>
<div class="block">For referential integrity before clusters are deleted remove all command links.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../../constant-values.html#com.netflix.genie.core.jpa.repositories.JpaClusterRepository.DELETE_TERMINATED_CLUSTERS_COMMANDS_REFERENCES_SQL">Constant Field Values</a></dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="findClustersAndCommandsForCriterion-java.util.Set-int-java.util.Set-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>findClustersAndCommandsForCriterion</h4>
<pre>@Query(value="SELECT   cc.cluster_id,  c.unique_id FROM  (    SELECT      cc.cluster_id as cluster_id,      MIN(cc.command_order) as command_order    FROM      (        SELECT          c.id as id        FROM          clusters c join          clusters_tags ct on c.id = ct.cluster_id join          tags t on ct.tag_id = t.id        WHERE          t.tag IN (:clusterTags) AND          c.status = \'UP\'        GROUP BY          c.id        HAVING          COUNT(c.id) = :clusterTagsCount      ) AS selected_clusters join      clusters_commands cc ON selected_clusters.id = cc.cluster_id join      (        SELECT          c.id as id        FROM          commands c join          commands_tags ct on c.id = ct.command_id join          tags t on ct.tag_id = t.id        WHERE          t.tag IN (:commandTags) AND          c.status = \'ACTIVE\'        GROUP BY          c.id        HAVING          COUNT(c.id) = :commandTagsCount      ) AS selected_commands ON selected_commands.id = cc.command_id    GROUP BY cc.cluster_id  ) as cluster_id_order join  clusters_commands cc on    cluster_id_order.cluster_id = cc.cluster_id AND    cc.command_order = cluster_id_order.command_order join  commands c on cc.command_id = c.id;",
       nativeQuery=true)
java.util.List&lt;java.lang.Object[]&gt;&nbsp;findClustersAndCommandsForCriterion(@Param(value="clusterTags")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    java.util.Set&lt;java.lang.String&gt;&nbsp;clusterTags,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    @Param(value="clusterTagsCount")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    int&nbsp;clusterTagsCount,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    @Param(value="commandTags")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    java.util.Set&lt;java.lang.String&gt;&nbsp;commandTags,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    @Param(value="commandTagsCount")
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    int&nbsp;commandTagsSize)</pre>
<div class="block">Find the cluster and command ids for the given criterion tags. The data is returned as a list of
 Long, Long results where the first Long is the cluster id and the second is the command id that should be used
 if that cluster is selected. The command id should be the highest priority command that matches the command
 criterion which has been associated with the given cluster by administrators.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>clusterTags</code> - The tags the cluster must match to be selected (conjunction). e.g. 'tag1','tag2','tag3'</dd>
<dd><code>clusterTagsCount</code> - The number of cluster tags (size of clusterTags)</dd>
<dd><code>commandTags</code> - The tags the command associated with the cluster must match to be selected. (conjunction)
                         e.g. 'tag1','tag2'</dd>
<dd><code>commandTagsSize</code> - The number of command tags (size of commandTags)</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The id pairs found or empty list if no matches</dd>
</dl>
</li>
</ul>
<a name="deleteTerminatedClusters--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteTerminatedClusters</h4>
<pre>@Modifying
 @Query(value="DELETE FROM clusters WHERE id NOT IN (SELECT DISTINCT(cluster_id) FROM jobs WHERE cluster_id IS NOT NULL) AND status = \'TERMINATED\';",
       nativeQuery=true)
int&nbsp;deleteTerminatedClusters()</pre>
<div class="block">Delete all clusters that are in a terminated state and aren't attached to any jobs.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of clusters deleted</dd>
</dl>
</li>
</ul>
<a name="deleteTerminatedClustersCommandsReferences--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteTerminatedClustersCommandsReferences</h4>
<pre>@Modifying
 @Query(value="DELETE FROM clusters_commands WHERE cluster_id IN ( SELECT id  FROM clusters  WHERE id NOT IN (SELECT DISTINCT(cluster_id) FROM jobs WHERE cluster_id IS NOT NULL)  AND status = \'TERMINATED\');",
       nativeQuery=true)
int&nbsp;deleteTerminatedClustersCommandsReferences()</pre>
<div class="block">Delete all links to clusters that are about to be terminated from commands.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of records deleted.</dd>
</dl>
</li>
</ul>
<a name="deleteTerminatedClustersConfigsFileReferences--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteTerminatedClustersConfigsFileReferences</h4>
<pre>@Modifying
 @Query(value="DELETE FROM clusters_configs WHERE cluster_id IN ( SELECT id  FROM clusters  WHERE id NOT IN (SELECT DISTINCT(cluster_id) FROM jobs WHERE cluster_id IS NOT NULL)  AND status = \'TERMINATED\');",
       nativeQuery=true)
int&nbsp;deleteTerminatedClustersConfigsFileReferences()</pre>
<div class="block">Delete all links to clusters that are about to be terminated from config file references.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of records deleted.</dd>
</dl>
</li>
</ul>
<a name="deleteTerminatedClustersDependenciesFileReferences--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>deleteTerminatedClustersDependenciesFileReferences</h4>
<pre>@Modifying
 @Query(value="DELETE FROM clusters_dependencies WHERE cluster_id IN ( SELECT id  FROM clusters  WHERE id NOT IN (SELECT DISTINCT(cluster_id) FROM jobs WHERE cluster_id IS NOT NULL)  AND status = \'TERMINATED\');",
       nativeQuery=true)
int&nbsp;deleteTerminatedClustersDependenciesFileReferences()</pre>
<div class="block">Delete all links to clusters that are about to be terminated from dependency file references.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of records deleted.</dd>
</dl>
</li>
</ul>
<a name="deleteTerminatedClustersTagsReferences--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>deleteTerminatedClustersTagsReferences</h4>
<pre>@Modifying
 @Query(value="DELETE FROM clusters_tags WHERE cluster_id IN ( SELECT id  FROM clusters  WHERE id NOT IN (SELECT DISTINCT(cluster_id) FROM jobs WHERE cluster_id IS NOT NULL)  AND status = \'TERMINATED\');",
       nativeQuery=true)
int&nbsp;deleteTerminatedClustersTagsReferences()</pre>
<div class="block">Delete all links to clusters that are about to be terminated from tags.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The number of records deleted.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaBaseRepository.html" title="interface in com.netflix.genie.core.jpa.repositories"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../com/netflix/genie/core/jpa/repositories/JpaCommandRepository.html" title="interface in com.netflix.genie.core.jpa.repositories"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?com/netflix/genie/core/jpa/repositories/JpaClusterRepository.html" target="_top">Frames</a></li>
<li><a href="JpaClusterRepository.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
